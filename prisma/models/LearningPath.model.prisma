// Níveis de profundidade da trilha
enum LearningPathLevel {
  BASIC
  INTERMEDIATE
  ADVANCED
}

// Tipo de conteúdo do passo
enum LearningContentType {
  ARTICLE // artigo / texto
  VIDEO // vídeo
  TOOL // planilha/ferramenta
  OTHER
}

model LearningPath {
  id          String @id @default(cuid())
  slug        String @unique
  title       String
  description String

  // Usa o enum que já temos do EPIC 2
  dimension FinancialDimension

  level            LearningPathLevel @default(BASIC)
  estimatedMinutes Int?
  isActive         Boolean           @default(true)
  order            Int               @default(0)

  steps LearningStep[]

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
}

model LearningStep {
  id             String @id @default(cuid())
  learningPathId String

  learningPath LearningPath @relation(fields: [learningPathId], references: [id], onDelete: Cascade)

  order            Int
  title            String
  type             LearningContentType
  xpContentUrl     String? // link para artigo/vídeo XP
  estimatedMinutes Int?

  progress UserLearningStepProgress[]

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
}

model UserLearningStepProgress {
  id             String @id @default(cuid())
  userXPId       String
  learningStepId String

  userXP       UserXP       @relation(fields: [userXPId], references: [id], onDelete: Cascade)
  learningStep LearningStep @relation(fields: [learningStepId], references: [id], onDelete: Cascade)

  completedAt DateTime @default(now())

  @@unique([userXPId, learningStepId])
}
